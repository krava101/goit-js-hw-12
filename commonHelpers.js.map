{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".search-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadBtn = document.querySelector(\".load-more-btn\");\n\nconst lboxOptions = {\n  captionsData: \"alt\",\n  captionDelay: 250\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', lboxOptions);\n\niziToast.settings({\n  messageColor: '#fff',\n  backgroundColor: '#EF4040',\n  position: 'topRight'\n});\n\nlet page = 1;\nlet perPage = 40;\nlet searchImg = '';\nlet totalHits = 500;\n\nasync function fetchPosts(searchImg) {\n  const searchParams = new URLSearchParams({\n    key: '41673326-36a35a0e0851ae97a957fbd95',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    q: searchImg,\n    page: page,\n    per_page: perPage\n  })\n  const response = await axios.get(`https://pixabay.com/api/?${searchParams}`);\n  return response.data; \n}\n\nasync function loadImages() {\n  loadBtn.classList.remove(\"load-btn-active\");\n  loader.classList.add(\"loader-active\");\n  if (gallery.children.length >= totalHits) {\n    loadBtn.classList.remove(\"load-btn-active\"); \n    loader.classList.remove(\"loader-active\");\n    return iziToast.show({message: \"We're sorry, but you've reached the end of search results.\"});\n  }\n  try {\n    const images = await fetchPosts(searchImg);\n    if (page === 1 && !images.hits.length) {\n     iziToast.show({ message: 'Sorry, there are no images matching your search query. Please try again!'});\n    } else {\n      page++;\n      totalHits = images.totalHits;\n      renderImages(images.hits);\n      loadBtn.classList.add(\"load-btn-active\");\n    } \n  } catch (error) { \n    iziToast.show({ message: `${error}`});\n  } finally {\n    loader.classList.remove(\"loader-active\");\n  }\n}\n\nform.addEventListener(\"submit\", event => {\n  event.preventDefault();\n  gallery.textContent = '';\n  page = 1;\n  searchImg = event.currentTarget.search.value;\n  loadImages();\n  event.currentTarget.reset();\n});\n\nloadBtn.addEventListener(\"click\", event => {\n  loadImages();\n})\n\nfunction renderImages(images) {\n  const str = images.reduce((acc, e) => acc + `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${e.largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${e.webformatURL}\"\n          data-source=\"${e.largeImageURL}\"\n          alt=\"${e.tags}\"\n        />\n      </a>\n      <ul>\n        <li><b>Likes</b> ${e.likes}</li>\n        <li><b>Views</b> ${e.views}</li>\n        <li><b>Comments</b> ${e.comments}</li>\n        <li><b>Downloads</b> ${e.downloads}</li>\n      </ul>\n    </li>`, ''\n  );\n  gallery.insertAdjacentHTML(\"beforeend\", str);\n  lightbox.refresh();\n  if (page > 2) {\n    const cardHeight = document.querySelectorAll(\".gallery-item\")[0].getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: \"smooth\"\n    });\n  }\n}"],"names":["form","gallery","loader","loadBtn","lboxOptions","lightbox","SimpleLightbox","iziToast","page","perPage","searchImg","totalHits","fetchPosts","searchParams","axios","loadImages","images","renderImages","error","event","str","acc","e","cardHeight"],"mappings":"+vBAMA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,gBAAgB,EAEjDC,EAAc,CAClB,aAAc,MACd,aAAc,GAChB,EAEMC,EAAW,IAAIC,EAAe,aAAcF,CAAW,EAE7DG,EAAS,SAAS,CAChB,aAAc,OACd,gBAAiB,UACjB,SAAU,UACZ,CAAC,EAED,IAAIC,EAAO,EACPC,EAAU,GACVC,EAAY,GACZC,EAAY,IAEhB,eAAeC,EAAWF,EAAW,CACnC,MAAMG,EAAe,IAAI,gBAAgB,CACvC,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,EAAGH,EACH,KAAMF,EACN,SAAUC,CACd,CAAG,EAED,OADiB,MAAMK,EAAM,IAAI,4BAA4BD,GAAc,GAC3D,IAClB,CAEA,eAAeE,GAAa,CAG1B,GAFAZ,EAAQ,UAAU,OAAO,iBAAiB,EAC1CD,EAAO,UAAU,IAAI,eAAe,EAChCD,EAAQ,SAAS,QAAUU,EAC7B,OAAAR,EAAQ,UAAU,OAAO,iBAAiB,EAC1CD,EAAO,UAAU,OAAO,eAAe,EAChCK,EAAS,KAAK,CAAC,QAAS,4DAA4D,CAAC,EAE9F,GAAI,CACF,MAAMS,EAAS,MAAMJ,EAAWF,CAAS,EACrCF,IAAS,GAAK,CAACQ,EAAO,KAAK,OAC9BT,EAAS,KAAK,CAAE,QAAS,0EAA0E,CAAC,GAEnGC,IACAG,EAAYK,EAAO,UACnBC,EAAaD,EAAO,IAAI,EACxBb,EAAQ,UAAU,IAAI,iBAAiB,EAE1C,OAAQe,EAAP,CACAX,EAAS,KAAK,CAAE,QAAS,GAAGW,GAAO,CAAC,CACxC,QAAY,CACRhB,EAAO,UAAU,OAAO,eAAe,CACxC,CACH,CAEAF,EAAK,iBAAiB,SAAUmB,GAAS,CACvCA,EAAM,eAAc,EACpBlB,EAAQ,YAAc,GACtBO,EAAO,EACPE,EAAYS,EAAM,cAAc,OAAO,MACvCJ,IACAI,EAAM,cAAc,OACtB,CAAC,EAEDhB,EAAQ,iBAAiB,QAASgB,GAAS,CACzCJ,GACF,CAAC,EAED,SAASE,EAAaD,EAAQ,CAC5B,MAAMI,EAAMJ,EAAO,OAAO,CAACK,EAAKC,IAAMD,EAAM;AAAA;AAAA,sCAERC,EAAE;AAAA;AAAA;AAAA,iBAGvBA,EAAE;AAAA,yBACMA,EAAE;AAAA,iBACVA,EAAE;AAAA;AAAA;AAAA;AAAA,2BAIQA,EAAE;AAAA,2BACFA,EAAE;AAAA,8BACCA,EAAE;AAAA,+BACDA,EAAE;AAAA;AAAA,WAErB,EACZ,EAGE,GAFArB,EAAQ,mBAAmB,YAAamB,CAAG,EAC3Cf,EAAS,QAAO,EACZG,EAAO,EAAG,CACZ,MAAMe,EAAa,SAAS,iBAAiB,eAAe,EAAE,GAAG,sBAAuB,EAAC,OACzF,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QAChB,CAAK,CACF,CACH"}