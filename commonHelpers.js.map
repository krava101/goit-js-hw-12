{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".search-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadBtn = document.querySelector(\".load-more-btn\");\n\niziToast.settings({\n  messageColor: '#fff',\n  backgroundColor: '#EF4040',\n  position: 'topRight'\n});\n\nlet page = 1;\nlet perPage = 40;\nlet searchImg = '';\n\nasync function fetchPosts(searchImg) {\n  const searchParams = new URLSearchParams({\n    key: '41673326-36a35a0e0851ae97a957fbd95',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    q: searchImg,\n    page: page,\n    per_page: perPage\n  })\n  const response = await axios.get(`https://pixabay.com/api/?${searchParams}`);\n  return response.data; \n}\n\nasync function loadImages() {\n  loadBtn.classList.remove(\"load-btn-active\");\n  loader.classList.add(\"loader-active\");\n  try {\n    const images = await fetchPosts(searchImg);\n    if (images.hits.length <= 0) {\n      iziToast.show({ message: 'Sorry, there are no images matching your search query. Please try again!'});\n      loader.classList.remove(\"loader-active\");\n    } else if (Math.ceil(images.totalHits / perPage) < page) {\n      iziToast.show({message: \"We're sorry, but you've reached the end of search results.\"})\n      loader.classList.remove(\"loader-active\");\n      loadBtn.classList.remove(\"load-btn-active\"); \n    } else {\n      renderImages(images.hits);\n      loader.classList.remove(\"loader-active\");\n      loadBtn.classList.add(\"load-btn-active\");\n    }\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  gallery.textContent = '';\n  page = 1;\n  searchImg = event.currentTarget.search.value;\n  loadImages();\n  event.currentTarget.reset();\n});\n\nloadBtn.addEventListener(\"click\", event => {\n  page++;\n  loadImages();\n})\n\nfunction renderImages(images) {\n  const str = images.reduce((acc, e) => acc + `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${e.largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${e.webformatURL}\"\n          data-source=\"${e.largeImageURL}\"\n          alt=\"${e.tags}\"\n        />\n      </a>\n      <ul>\n        <li><b>Likes</b> ${e.likes}</li>\n        <li><b>Views</b> ${e.views}</li>\n        <li><b>Comments</b> ${e.comments}</li>\n        <li><b>Downloads</b> ${e.downloads}</li>\n      </ul>\n    </li>`, ''\n  );\n  gallery.insertAdjacentHTML(\"beforeend\", str);\n  lightbox.refresh();\n}\n\nconst lboxOptions = {\n  captionsData: \"alt\",\n  captionDelay: 250\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', lboxOptions);\n\n"],"names":["form","gallery","loader","loadBtn","iziToast","page","perPage","searchImg","fetchPosts","searchParams","axios","loadImages","images","renderImages","error","event","str","acc","e","lightbox","lboxOptions","SimpleLightbox"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,gBAAgB,EAEvDC,EAAS,SAAS,CAChB,aAAc,OACd,gBAAiB,UACjB,SAAU,UACZ,CAAC,EAED,IAAIC,EAAO,EACPC,EAAU,GACVC,EAAY,GAEhB,eAAeC,EAAWD,EAAW,CACnC,MAAME,EAAe,IAAI,gBAAgB,CACvC,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,EAAGF,EACH,KAAMF,EACN,SAAUC,CACd,CAAG,EAED,OADiB,MAAMI,EAAM,IAAI,4BAA4BD,GAAc,GAC3D,IAClB,CAEA,eAAeE,GAAa,CAC1BR,EAAQ,UAAU,OAAO,iBAAiB,EAC1CD,EAAO,UAAU,IAAI,eAAe,EACpC,GAAI,CACF,MAAMU,EAAS,MAAMJ,EAAWD,CAAS,EACrCK,EAAO,KAAK,QAAU,GACxBR,EAAS,KAAK,CAAE,QAAS,0EAA0E,CAAC,EACpGF,EAAO,UAAU,OAAO,eAAe,GAC9B,KAAK,KAAKU,EAAO,UAAYN,CAAO,EAAID,GACjDD,EAAS,KAAK,CAAC,QAAS,4DAA4D,CAAC,EACrFF,EAAO,UAAU,OAAO,eAAe,EACvCC,EAAQ,UAAU,OAAO,iBAAiB,IAE1CU,EAAaD,EAAO,IAAI,EACxBV,EAAO,UAAU,OAAO,eAAe,EACvCC,EAAQ,UAAU,IAAI,iBAAiB,EAE1C,OAAQW,EAAP,CACA,QAAQ,MAAMA,CAAK,CACpB,CACH,CAGAd,EAAK,iBAAiB,SAAU,MAAOe,GAAU,CAC/CA,EAAM,eAAc,EACpBd,EAAQ,YAAc,GACtBI,EAAO,EACPE,EAAYQ,EAAM,cAAc,OAAO,MACvCJ,IACAI,EAAM,cAAc,OACtB,CAAC,EAEDZ,EAAQ,iBAAiB,QAASY,GAAS,CACzCV,IACAM,GACF,CAAC,EAED,SAASE,EAAaD,EAAQ,CAC5B,MAAMI,EAAMJ,EAAO,OAAO,CAACK,EAAKC,IAAMD,EAAM;AAAA;AAAA,sCAERC,EAAE;AAAA;AAAA;AAAA,iBAGvBA,EAAE;AAAA,yBACMA,EAAE;AAAA,iBACVA,EAAE;AAAA;AAAA;AAAA;AAAA,2BAIQA,EAAE;AAAA,2BACFA,EAAE;AAAA,8BACCA,EAAE;AAAA,+BACDA,EAAE;AAAA;AAAA,WAErB,EACZ,EACEjB,EAAQ,mBAAmB,YAAae,CAAG,EAC3CG,EAAS,QAAO,CAClB,CAEA,MAAMC,EAAc,CAClB,aAAc,MACd,aAAc,GAChB,EAEMD,EAAW,IAAIE,EAAe,aAAcD,CAAW"}